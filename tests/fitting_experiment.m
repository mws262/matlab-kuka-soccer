function fitting_experiment
test_dat = [   -0.9533    1.0007    0.6627   -2.0563   -1.3323   -0.9992         0
   -0.9400    0.9950    0.6487   -2.0541   -1.3258   -1.0162         0
   -0.9238    0.9900    0.6379   -2.0484   -1.3162   -1.0224         0
   -0.9000    0.9834    0.6229   -2.0397   -1.3019   -1.0304         0
   -0.8716    0.9769    0.6066   -2.0280   -1.2845   -1.0374         0
   -0.8278    0.9645    0.5756   -2.0139   -1.2590   -1.0519         0
   -0.7912    0.9568    0.5592   -1.9965   -1.2361   -1.0359         0
   -0.7574    0.9528    0.5497   -1.9758   -1.2147   -1.0069         0
   -0.7040    0.9421    0.5170   -1.9532   -1.1846   -0.9973         0
   -0.6308    0.9263    0.4599   -1.9291   -1.1455   -1.0074         0
   -0.5547    0.9142    0.3987   -1.9026   -1.1052   -1.0234         0
   -0.4870    0.9095    0.3468   -1.8731   -1.0682   -1.0396         0
   -0.4315    0.9113    0.3099   -1.8402   -1.0358   -1.0516         0
   -0.3861    0.9181    0.2866   -1.8043   -1.0066   -1.0581         0
   -0.3196    0.9204    0.2355   -1.7714   -0.9613   -1.0958         0
   -0.2954    0.9311    0.2372   -1.7390   -0.9354   -1.1100         0
   -0.3085    0.9477    0.2842   -1.7095   -0.9255   -1.1201         0
   -0.3412    0.9694    0.3558   -1.6828   -0.9260   -1.1284         0
   -0.3884    0.9984    0.4470   -1.6589   -0.9355   -1.1365         0
   -0.4562    1.0426    0.5690   -1.6373   -0.9602   -1.1363         0
   -0.5298    1.1035    0.7059   -1.6181   -0.9960   -1.1276         0
   -0.6029    1.1836    0.8529   -1.6017   -1.0423   -1.1063         0
   -0.6420    1.2491    0.9550   -1.5897   -1.0733   -1.0994         0
   -0.6771    1.3220    1.0579   -1.5820   -1.1073   -1.0884         0
   -0.7016    1.3905    1.1467   -1.5793   -1.1362   -1.0824         0
   -0.7227    1.4721    1.2447   -1.5827   -1.1647   -1.0764         0
   -0.7355    1.5339    1.3143   -1.5925   -1.1842   -1.0801         0
   -0.7387    1.5741    1.3575   -1.6055   -1.1834   -1.0933         0
   -0.7616    1.6836    1.4671   -1.6307   -1.2423   -1.0871         0
   -0.7756    1.8744    1.6464   -1.6583   -1.3464   -1.0156         0
   -0.7735    1.8987    1.6607   -1.6843   -1.3331   -1.0536         0
   -0.7692    1.8005    1.5595   -1.7135   -1.2580   -1.1813         0
   -0.7424    1.6430    1.4097   -1.7510   -1.1881   -1.3624         0
   -0.3212    1.0436    0.6474   -1.8147   -0.9517   -2.0944         0
   -0.3352    1.0503    0.6914   -1.8476   -0.9261   -2.0944         0
   -0.3703    1.0726    0.7648   -1.8784   -0.9054   -2.0647         0
   -0.7227    1.6604    1.4753   -1.7955   -0.7036   -1.2950         0
   -0.7242    1.6715    1.4832   -1.8207   -0.6267   -1.3055         0
   -0.7262    1.6800    1.4886   -1.8441   -0.5487   -1.3141         0
   -0.7284    1.6894    1.4946   -1.8645   -0.4738   -1.3202         0
   -0.7283    1.6939    1.4965   -1.8820   -0.4005   -1.3272         0
   -0.7235    1.6851    1.4889   -1.8958   -0.3237   -1.3372         0
   -0.7192    1.6799    1.4842   -1.9078   -0.2522   -1.3442         0
   -0.7153    1.6766    1.4812   -1.9176   -0.1841   -1.3485         0
   -0.7121    1.6754    1.4797   -1.9259   -0.1223   -1.3509         0
   -0.7096    1.6754    1.4792   -1.9327   -0.0676   -1.3521         0
   -0.7078    1.6761    1.4793   -1.9381   -0.0214   -1.3524         0
   -0.7063    1.6761    1.4790   -1.9416    0.0172   -1.3519         0
   -0.7054    1.6761    1.4786   -1.9437    0.0450   -1.3509         0
   -0.7049    1.6748    1.4776   -1.9442    0.0628   -1.3497         0];

breaks = [         0
    0.1005
    0.2010
    0.3015
    0.4020
    0.5025
    0.6030
    0.7035
    0.8040
    0.9045
    1.0050
    1.1055
    1.2060
    1.3065
    1.4070
    1.5075
    1.6080
    1.7085
    1.8090
    1.9095
    2.0101
    2.1106
    2.2111
    2.3116
    2.4121
    2.5377
    2.6382
    2.7387
    2.8392
    2.9397
    3.0402
    3.1407
    3.2412
    3.3417
    3.4422
    3.5427
    3.6432
    3.7437
    3.8442
    3.9447
    4.0452
    4.1457
    4.2462
    4.3467
    4.4472
    4.5477
    4.6482
    4.7487
    4.8492
    4.9749];

	init_spl = spline(breaks, test_dat');
    figure;
    plot(ppval(init_spl,breaks));
    hold on;
    
    extranodes_guess = rand(size(test_dat,1) - 1,7);

    
    [sol, fval] = fminsearch(@cost_fun, extranodes_guess)
  
            allknots = zeros(size(test_dat,1)*2 - 1, 7);
        extra_nodes = reshape(sol,[],7);
        allknots(1:2:end,:) = test_dat;
        allknots(2:2:end,:) = extra_nodes;
        
        spl = spline(linspace(0,5,size(allknots,1)), allknots');
        plot(ppval(spl,linspace(0,5,size(allknots,1))));
    
    disp(fval);
    function cost = cost_fun(X)
        allknots = zeros(size(test_dat,1)*2 - 1, 7);
        extra_nodes = reshape(X,[],7);
        allknots(1:2:end,:) = test_dat;
        allknots(2:2:end,:) = extra_nodes;
        
        spl = spline(linspace(0,5,size(allknots,1)), allknots');
        cost = sum(spl.coefs(:,2).^2);  
    end
        




end



